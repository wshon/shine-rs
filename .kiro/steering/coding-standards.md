# 编码规范

## 代码质量要求

### 编译警告处理
- **立即修复所有编译警告** - 不允许提交包含警告的代码
- 使用 `cargo clippy` 进行代码检查，修复所有clippy建议
- 定期运行 `cargo check` 确保代码编译通过
- 在CI/CD中启用 `-D warnings` 将警告视为错误

### 文件结构和职责
- **单一职责原则** - 每个文件应专注于一个核心功能模块
- 文件大小控制在合理范围内（通常不超过500行）
- 相关功能模块化，避免单个文件承担过多责任
- 清晰的模块边界和接口定义

### 算法实现标准
- **严格参考 ref/shine 实现** - 所有MP3编码算法必须与shine库保持一致
- 计算参数、常量、查找表等必须与shine源码对应
- 算法逻辑流程应与shine实现保持相同的步骤和顺序
- 数值计算精度要求与shine保持一致

## 代码风格

### 命名规范
- 使用 `snake_case` 命名变量和函数
- 使用 `PascalCase` 命名结构体和枚举
- 常量使用 `SCREAMING_SNAKE_CASE`
- 模块名使用 `snake_case`

### 文档要求
- 所有公共API必须有文档注释
- 复杂算法需要详细的实现说明
- 引用shine源码时注明对应的文件和函数

### 错误处理
- 使用 `Result<T, E>` 进行错误处理
- 自定义错误类型要有清晰的错误信息
- 避免使用 `unwrap()` 和 `expect()`，除非在测试代码中

## 测试要求
- 每个模块都应有对应的单元测试
- 算法实现需要与shine输出进行对比测试
- 使用 `cargo test` 确保所有测试通过